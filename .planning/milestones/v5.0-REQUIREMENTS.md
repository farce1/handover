# Requirements Archive: v5.0 Remote & Advanced MCP

**Archived:** 2026-02-26
**Status:** âœ… SHIPPED
**Audit Reference:** `.planning/milestones/v5.0-MILESTONE-AUDIT.md` (`status: tech_debt`, requirements 17/17)

## Outcome Summary

- Total requirements: 17
- Final completion: 17/17 complete
- Outcomes: 17 validated, 0 adjusted, 0 dropped

## Shipped Requirements (Final)

### Streaming QA (RMT-04)

- [x] **RMT-05**: User can request QA in streaming mode and receive incremental progress updates during long responses
- [x] **RMT-06**: User can cancel an in-flight streaming QA request and receive cancellation confirmation
- [x] **RMT-07**: User receives the same final structured QA response contract in both streaming and non-streaming modes
- [x] **RMT-08**: User can resume a dropped streaming QA session and continue from the last acknowledged stream position

### Remote Regeneration Tooling (RMT-01)

- [x] **RMT-09**: User can invoke `regenerate_docs` as an MCP tool from a remote MCP client
- [x] **RMT-10**: User can view deterministic regeneration job states (`queued`, `running`, `completed`, `failed`)
- [x] **RMT-11**: User submitting duplicate regeneration requests for the same target gets single-flight behavior instead of duplicate concurrent runs

### HTTP Transport and Security (RMT-02)

- [x] **RMT-12**: User can start MCP server with optional Streamable HTTP transport while stdio remains the default transport
- [x] **RMT-13**: User can access the same MCP tools, resources, and prompts over stdio and HTTP with equivalent behavior
- [x] **RMT-14**: User requests from disallowed HTTP origins are rejected with clear remediation messaging
- [x] **RMT-15**: User running HTTP mode locally gets localhost-safe bind defaults unless explicitly overridden
- [x] **RMT-16**: User can configure authentication hooks or credentials for non-localhost HTTP deployments
- [x] **RMT-17**: User receives clear authentication failure diagnostics when HTTP requests are unauthorized

### Local Embeddings and Validation (RMT-03)

- [x] **RMT-18**: User can configure an Ollama-compatible local embedding provider path for indexing and retrieval
- [x] **RMT-19**: User gets fail-fast validation when embedding model or dimension does not match stored index metadata
- [x] **RMT-20**: User can select embedding locality policy mode (`local-only`, `local-preferred`, `remote-only`)
- [x] **RMT-21**: User can run embedding provider health checks and receive actionable diagnostics before indexing

## Requirement Outcomes

| Requirement | Outcome | Notes |
|-------------|---------|-------|
| RMT-05 | Validated | Streaming QA lifecycle tool contracts and progress delivery shipped in Phase 16 |
| RMT-06 | Validated | In-flight cancellation with explicit confirmation shipped in Phase 16 |
| RMT-07 | Validated | Streaming/non-streaming final payload parity preserved in Phase 16 |
| RMT-08 | Validated | Cursor-safe replay and resume behavior shipped in Phase 16 |
| RMT-09 | Validated | `regenerate_docs` remote MCP trigger shipped in Phase 18 |
| RMT-10 | Validated | Deterministic regeneration state transitions shipped in Phase 18 |
| RMT-11 | Validated | Single-flight dedupe semantics shipped in Phase 18 |
| RMT-12 | Validated | Optional Streamable HTTP transport shipped in Phase 19 |
| RMT-13 | Validated | Stdio/HTTP capability parity shipped in Phase 19 |
| RMT-14 | Validated | Origin policy middleware with remediation shipped in Phase 20 |
| RMT-15 | Validated | Loopback-safe bind defaults and startup guard shipped in Phase 20 |
| RMT-16 | Validated | Non-loopback auth prerequisite and runtime auth wiring shipped in Phase 20 |
| RMT-17 | Validated | Structured unauthorized diagnostics shipped in Phase 20 |
| RMT-18 | Validated | Local embedding provider config and routing shipped in Phase 17 |
| RMT-19 | Validated | Fail-fast metadata compatibility validation shipped in Phase 17 |
| RMT-20 | Validated | Locality mode policy selection and per-run overrides shipped in Phase 17 |
| RMT-21 | Validated | Embedding health checks and diagnostics shipped in Phase 17 |

## Final Traceability

| Requirement | Phase | Final Status |
|-------------|-------|--------------|
| RMT-05 | Phase 16 | Complete |
| RMT-06 | Phase 16 | Complete |
| RMT-07 | Phase 16 | Complete |
| RMT-08 | Phase 16 | Complete |
| RMT-09 | Phase 18 | Complete |
| RMT-10 | Phase 18 | Complete |
| RMT-11 | Phase 18 | Complete |
| RMT-12 | Phase 19 | Complete |
| RMT-13 | Phase 19 | Complete |
| RMT-14 | Phase 20 | Complete |
| RMT-15 | Phase 20 | Complete |
| RMT-16 | Phase 20 | Complete |
| RMT-17 | Phase 20 | Complete |
| RMT-18 | Phase 17 | Complete |
| RMT-19 | Phase 17 | Complete |
| RMT-20 | Phase 17 | Complete |
| RMT-21 | Phase 17 | Complete |

## Deferred to Future Milestones

- **RMT-22**: User can resume dropped remote regeneration streams for long-running documentation builds
- **RMT-23**: User can view transport-aware diagnostics for mixed stdio and HTTP deployments
- **RMT-24**: User can schedule automatic regeneration runs
- **RMT-25**: User can run prioritized parallel regeneration queues for high-concurrency hosted usage
- **RMT-26**: User can manage multi-tenant hosted remote MCP operations from a control plane

## Out of Scope (v5.0)

| Feature | Reason |
|---------|--------|
| Mandatory HTTP transport replacing stdio | Breaks existing local MCP workflows; v5.0 required additive transport support |
| Third-party token passthrough from MCP client to upstream APIs | Security anti-pattern; weakens trust boundaries and auditability |
| Fire-and-forget regeneration with no progress/cancel | Poor UX for long jobs and no safe retry visibility |
| Streaming partial markdown artifacts during regeneration | Produces inconsistent docs and complicates validation pipeline |
| Always-on background auto-regeneration daemon | Adds operational complexity and race risks without milestone-critical value |

---

_For new milestone requirements, create a fresh `.planning/REQUIREMENTS.md` via `/gsd-new-milestone`._
